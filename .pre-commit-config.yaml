# =============================================================================
# Pre-commit Configuration - RiseCheckout
# =============================================================================
#
# Este arquivo configura hooks de pre-commit para prevenir commits de secrets
# e outras vulnerabilidades de seguran√ßa.
#
# INSTALA√á√ÉO:
#   pip install pre-commit
#   pre-commit install
#
# EXECU√á√ÉO MANUAL:
#   pre-commit run --all-files
#
# =============================================================================

repos:
  # -------------------------------------------------------------------------
  # Gitleaks - Detec√ß√£o de Secrets (USA CONFIG CUSTOMIZADO)
  # -------------------------------------------------------------------------
  # Previne commits de API keys, tokens, senhas e outros secrets
  # Usa regras customizadas definidas em .gitleaks.toml
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.18.4
    hooks:
      - id: gitleaks
        name: üîê Gitleaks - Detectar secrets expostos
        description: Verifica se h√° secrets (API keys, tokens, senhas) no c√≥digo
        entry: gitleaks protect --staged --verbose --redact --config=.gitleaks.toml
        language: system
        pass_filenames: false

  # -------------------------------------------------------------------------
  # Hooks padr√£o do pre-commit
  # -------------------------------------------------------------------------
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      # Previne commits de arquivos grandes que podem conter dados sens√≠veis
      - id: check-added-large-files
        name: üì¶ Verificar arquivos grandes
        args: ['--maxkb=500']
      
      # Previne commits de arquivos com conflitos de merge n√£o resolvidos
      - id: check-merge-conflict
        name: ‚ö†Ô∏è Verificar conflitos de merge
      
      # Verifica se arquivos JSON est√£o v√°lidos
      - id: check-json
        name: üìã Validar JSON
      
      # Verifica se arquivos YAML est√£o v√°lidos
      - id: check-yaml
        name: üìã Validar YAML
      
      # Remove whitespace no final das linhas
      - id: trailing-whitespace
        name: üßπ Remover whitespace trailing
        args: [--markdown-linebreak-ext=md]
      
      # Garante que arquivos terminam com newline
      - id: end-of-file-fixer
        name: üìÑ Corrigir final de arquivo

  # -------------------------------------------------------------------------
  # ESLint para TypeScript/JavaScript
  # -------------------------------------------------------------------------
  - repo: local
    hooks:
      - id: eslint
        name: üîç ESLint - Verificar c√≥digo TypeScript
        entry: npx eslint --fix
        language: system
        types: [typescript, javascript]
        files: \.(ts|tsx|js|jsx)$
        pass_filenames: true

# =============================================================================
# Configura√ß√µes Globais
# =============================================================================
default_install_hook_types: [pre-commit, pre-push]
default_stages: [pre-commit]
fail_fast: false

# Arquivos a serem ignorados globalmente
exclude: |
  (?x)^(
    node_modules/|
    dist/|
    build/|
    .git/|
    bun.lockb|
    package-lock.json|
    \.min\.(js|css)$
  )
