# ============================================
# SUPABASE - FRONTEND
# ============================================
# The frontend does NOT use any Supabase keys directly.
# All requests are proxied through the API Gateway (api.risecheckout.com).
# The Cloudflare Worker injects the publishable key automatically.
#
# If you need the Supabase URL for debugging:
VITE_SUPABASE_URL=https://your-project-id.supabase.co

# ============================================
# SUPABASE - BACKEND (Edge Functions)
# ============================================
# These env vars are auto-injected by Supabase into Edge Functions.
# After migrating to new API keys:
#   - SUPABASE_ANON_KEY contains: sb_publishable_... (publishable key)
#   - SUPABASE_SERVICE_ROLE_KEY contains: sb_secret_... (secret key - "general" domain)
# The env var NAMES are kept by Supabase for backwards compatibility.
#
# Additional secrets to configure (Supabase Dashboard > Settings > Edge Functions):
SUPABASE_SERVICE_ROLE_KEY=your-secret-key-here

# ============================================
# MULTI-SECRET KEY DOMAINS (Edge Functions)
# ============================================
# Each domain has its own secret key for blast-radius isolation.
# Create 3 additional secret keys in Supabase Dashboard > API Keys,
# then configure them as Edge Function secrets.
#
# Domain: webhooks (10 functions - inbound/outbound webhook processing)
RISE_SECRET_WEBHOOKS=sb_secret_your-webhooks-key-here
#
# Domain: payments (18 functions - payment creation, reconciliation, access granting)
RISE_SECRET_PAYMENTS=sb_secret_your-payments-key-here
#
# Domain: admin (17 functions - security, crypto, GDPR, vault, role management)
RISE_SECRET_ADMIN=sb_secret_your-admin-key-here
#
# Domain: general (62 functions) - uses SUPABASE_SERVICE_ROLE_KEY (auto-injected)
# No additional configuration needed for this domain.

# ============================================
# CLOUDFLARE WORKER (API Gateway)
# ============================================
# The Cloudflare Worker at api.risecheckout.com needs:
#   SUPABASE_PUBLISHABLE_KEY=sb_publishable_... (from Supabase Dashboard > API Keys)
# Configure via Cloudflare Dashboard or Wrangler CLI.

# ============================================
# MERCADO PAGO (P0-3: OAuth Seguro)
# ============================================
# Frontend (not needed - Worker handles it)
# VITE_MERCADOPAGO_CLIENT_ID is only used for OAuth redirect URL construction

# Backend (Edge Functions Secrets)
MERCADOPAGO_CLIENT_ID=your-mercadopago-client-id-here
MERCADOPAGO_CLIENT_SECRET=your-mercadopago-client-secret-here
MERCADOPAGO_REDIRECT_URI=https://your-project-id.supabase.co/functions/v1/mercadopago-oauth-callback

# ============================================
# SEGURANÇA (P0-5: Trigger Webhooks)
# ============================================
# Backend (Edge Functions Secrets + Vault)
INTERNAL_WEBHOOK_SECRET=your-internal-webhook-secret-here

# ============================================
# PUSHING PAY (Gateway de Pagamento)
# ============================================
# Secret usado para validar webhooks do PushingPay
PUSHINGPAY_WEBHOOK_SECRET=your-pushingpay-webhook-secret-here

# API Key do PushingPay (para criar pagamentos)
PUSHINGPAY_API_KEY=your-pushingpay-api-key-here

# ============================================
# N8N (Automação de Workflows)
# ============================================
# URL do webhook do n8n para receber eventos de pedidos
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/orders

# ============================================
# CRON JOBS
# ============================================
# Secret usado para autenticar chamadas dos cron jobs
CRON_SECRET=your-cron-secret-here

# ============================================
# COMO CONFIGURAR
# ============================================
# 1. FRONTEND:
#    No Lovable/Cloudflare, não é necessário configurar chaves.
#    O Worker injeta a publishable key automaticamente.
#
# 2. BACKEND (Secrets do Supabase):
#    Configure via Supabase Dashboard: Settings > Edge Functions > Manage secrets
#
#    Ou via CLI:
#    supabase secrets set MERCADOPAGO_CLIENT_SECRET=your-mercadopago-secret
#    supabase secrets set MERCADOPAGO_REDIRECT_URI=https://your-project.supabase.co/functions/v1/mercadopago-oauth-callback
#    supabase secrets set INTERNAL_WEBHOOK_SECRET=your-internal-secret
#    supabase secrets set PUSHINGPAY_WEBHOOK_SECRET=your-webhook-secret
#    supabase secrets set PUSHINGPAY_API_KEY=your-api-key
#    supabase secrets set N8N_WEBHOOK_URL=https://your-n8n.com/webhook
#    supabase secrets set CRON_SECRET=your-cron-secret
#
# 3. CLOUDFLARE WORKER:
#    Update the Worker secret with the new publishable key:
#    wrangler secret put SUPABASE_PUBLISHABLE_KEY
#    (paste: sb_publishable_...)
